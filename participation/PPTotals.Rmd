---
title: "MATH 216 Participation Points Totals"
date: Last updated on `r format(Sys.time(), '%d %B, %Y')`
output: html_document
---

```{r setup, include=FALSE}
library(gsheet)
library(tidyverse)
library(randomcoloR)
library(kableExtra)

data <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1-5Tz0ogZvO2k1Dv1lIW8W_YuY0qH2AZb1MmZmN6_wy4/edit?usp=sharing')

totals <- data %>% 
  group_by(Name) %>% 
  summarize(total = sum(Points)) 

set.seed(1)
totals$key <- distinctColorPalette(26)
set.seed(1)
totals$key2 <- sample(letters)

total_sort<- totals %>% 
  select(total, key2) %>% 
  arrange(-total)
```


```{r echo=F}
kable(total_sort) %>% 
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F)
```

```{r include=FALSE}
for(i in totals$Name){

test <- data %>% 
  filter(Name == i) 
key <- totals %>% 
  filter(Name == i) 

key$key<-sub(".", "", key$key)
  write.csv(test, paste(key$key,"csv", sep="."))
}
```



